<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    </link>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet" />
    <style>
      html {
        -webkit-print-color-adjust: exact;
      }
      .print-page {
        break-before: page;
        padding-top: 30px;
      }
      a {
        text-decoration: none;
        color: inherit;
      }
      canvas {
        height: 100%;
      }

      .progress-bar-container {
        width: 100%;
        background-color: #f3f3f3;
        border-radius: 25px;
        margin: 30px 0;
      }

      .progress-bar {
        height: 24px;
        border-radius: 25px;
        background-color: #090c9b;
        color: white;
        text-align: center;
        line-height: 20px;
      }
      table tbody tr:nth-child(odd) {
        background-color: #ededed;
      }
      .gauge-container {
        display: flex;
        justify-content: space-around;
        margin-top: 20px;
      }
      .gauge-value-label {
        text-align: center;
        color: #000000;
        margin-bottom: 10px;
      }
      .gauge-risk-label {
        font-weight: bold;
        text-align: center;
        color: #090c9a;
        margin-top: -80px;
      }      
    </style>
</head>

<body style="
    font-family: 'Montserrat', sans-serif;
    margin: 0;
    width: 1240px;
    margin: 0 auto;
    padding-top: 0;
    overflow-x: hidden;
  ">

  <div style="padding: 0 140px;">
    <!-- About this report -->
    <div class="print-page" id="<%= data.about_this_report.id %>">
        <div>
            <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin-bottom: 0;">
                About this report
            </p>
            <p style="font-size: 19px; color: #000; text-align: justify; margin: 5px 0;">
                This report summarizes the topics that are particularly important among various information, security incidents and events that occurred during 
                <span style="font-weight: bold; font-size: 19px;"><%= data.about_this_report.date %></span> 
                and the changes in the environment surrounding them.
            </p>
        </div>
        <div>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 40px;">
                <% data.about_this_report.data.forEach((item, i) => { %>
                <div style="grid-column: span 1;" class="<%= i === 2 || i === 3 ? 'print-page' : '' %>" >
                    <p style="color: #090c9b; font-size: 1.6rem; font-weight: 600; margin: 0;">
                    <%= item.title %>
                    </p>
                    <p style="font-size: 19px; color: #000; text-align: justify;">
                    <%= item.desc %>
                    </p>
                    <% if (item.sub) { %>
                    <% item.sub.forEach((j, k) => { %>
                        <div>
                        <p style="font-size: 26px; color: #4d51da; margin-top: 15px; margin-bottom: 5px;">
                            <%= k + 1 %>. <%= j.title %>
                        </p>
                        <p style="font-size: 19px; text-align: justify; margin: 0;">
                            <%= j.desc %>
                        </p>
                        </div>
                    <% }); %>
                    <% } %>
                </div>
                <% }); %>
                <div style="grid-column: span 1; width: 300px; height: 400px; margin-top: 60px;">
                  <canvas id="workloadSecurity" width="400" height="400"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Executive summary -->
    <div class="print-page" id="<%= data.executive_summary.id %>">
        <div>
            <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin-bottom: 0;">
                Executive Summary
            </p>
            <p style="font-size: 19px; color: #000; margin: 10px 0; text-align: justify;">
                This executive summary provides a condensed overview of the Managed Extended Detection and Response (MXDR) Security Operations Center as a Service (SOCaaS) activities and observations for the month of <span style="font-weight: bold; font-size: 19px;"><%= data.executive_summary.date %></span>. It offers insights into the key security incidents, response and recommendations for your organization's cybersecurity infrastructure.
            </p>
            </div>
            <% if (data.executive_summary) { %>
            <div style="display: grid; grid-template-columns: repeat(1, 1fr);">
            <div style="grid-column: span 1; text-align: justify; margin-bottom: 0;">
                <div style="display: flex; gap: 20px; margin: 5px 0;">
                <img style="width: 60px;" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB4PSIwIiB5PSIwIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTEyIDUxMiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgY2xhc3M9IiI+PGc+PHBhdGggZD0iTTMzNC45NzQgMGMtOTUuNDE5IDAtMTczLjA0OSA3Ny42My0xNzMuMDQ5IDE3My4wNDkgMCAyMS4yMTMgMy43NjkgNDEuODI3IDExLjIxMSA2MS40MDNMNy42NzIgMzk5LjkyOGExMi42MTMgMTIuNjEzIDAgMCAwLTMuNjk0IDguOTE3djkwLjU0NGMwIDYuOTY1IDUuNjQ2IDEyLjYxMSAxMi42MTEgMTIuNjExaDc0LjYxNmExMi42MSAxMi42MSAwIDAgMCA4LjkxLTMuNjg2bDI1LjE0NS0yNS4xMDdhMTIuNjEgMTIuNjEgMCAwIDAgMy43MDEtOC45MjV2LTMwLjg3NmgzMC44MzdjNi45NjUgMCAxMi42MTEtNS42NDYgMTIuNjExLTEyLjYxMXYtMTIuMzZoMTIuMzYxYzYuOTY0IDAgMTIuNjExLTUuNjQ2IDEyLjYxMS0xMi42MTF2LTI3LjEzNmgyNy4xMzZjMy4zNDQgMCA2LjU1MS0xLjMyOSA4LjkxNy0zLjY5NGw0MC4xMjEtNDAuMTIxYzE5LjU3OSA3LjQ0OSA0MC4xOTYgMTEuMjIzIDYxLjQxNyAxMS4yMjMgOTUuNDE5IDAgMTczLjA0OS03Ny42MyAxNzMuMDQ5LTE3My4wNDlDNTA4LjAyMiA3Ny42MyA0MzAuMzkzIDAgMzM0Ljk3NCAwem0wIDMyMC44NzRjLTIwLjY0MiAwLTQwLjYwNi00LjE2OS01OS4zMzktMTIuMzkzLTQuODQ0LTIuMTI2LTEwLjI5OS0uOTU2LTEzLjg3MSAyLjUyNS0uMDM5LjAzNy0uMDc3LjA2Ny0uMTE1LjEwNmwtNDIuMzU0IDQyLjM1NGgtMzQuNTIzYy02Ljk2NSAwLTEyLjYxMSA1LjY0Ni0xMi42MTEgMTIuNjExdjI3LjEzNkgxNTkuOGMtNi45NjQgMC0xMi42MTEgNS42NDYtMTIuNjExIDEyLjYxMXYxMi4zNmgtMzAuODM4Yy02Ljk2NCAwLTEyLjYxMSA1LjY0Ni0xMi42MTEgMTIuNjExdjM4LjI1N2wtMTcuNzUzIDE3LjcyNUgyOS4yMDJ2LTE3LjgyMWwxNTQuMTQxLTE1NC4xNGM0LjQzMy00LjQzMyA0LjQzMy0xMS42MTkgMC0xNi4wNTFzLTExLjYxNy00LjQzNC0xNi4wNTMgMEwyOS4yMDIgNDM2Ljg1NFY0MTQuMDdsMTY3LjY5Ni0xNjcuNzA4Yy4wMzgtLjAzOC4wNjctLjA3My4xMDItLjExIDMuNDgyLTMuNTY5IDQuNjU2LTkuMDI0IDIuNTMtMTMuODcyLTguMjE2LTE4LjczMi0xMi4zOC0zOC42OTUtMTIuMzgtNTkuMzMgMC04MS41MTIgNjYuMzE1LTE0Ny44MjcgMTQ3LjgyNy0xNDcuODI3UzQ4Mi44MDIgOTEuNTM3IDQ4Mi44MDIgMTczLjA1Yy0uMDAyIDgxLjUxLTY2LjMxOCAxNDcuODI0LTE0Ny44MjggMTQ3LjgyNHoiIGZpbGw9IiNiNGI0YjQiIG9wYWNpdHk9IjEiIGRhdGEtb3JpZ2luYWw9IiMwMDAwMDAiIGNsYXNzPSIiPjwvcGF0aD48cGF0aCBkPSJNMzg3LjYzOCA3My4xNDRjLTI2LjA0NyAwLTQ3LjIzNyAyMS4xOS00Ny4yMzcgNDcuMjM3czIxLjE5IDQ3LjIzNyA0Ny4yMzcgNDcuMjM3IDQ3LjIzNy0yMS4xOSA0Ny4yMzctNDcuMjM3LTIxLjE4OS00Ny4yMzctNDcuMjM3LTQ3LjIzN3ptMCA2OS4yNTJjLTEyLjEzOSAwLTIyLjAxNS05Ljg3Ni0yMi4wMTUtMjIuMDE1czkuODc2LTIyLjAxNSAyMi4wMTUtMjIuMDE1IDIyLjAxNSA5Ljg3NiAyMi4wMTUgMjIuMDE1LTkuODc2IDIyLjAxNS0yMi4wMTUgMjIuMDE1eiIgZmlsbD0iI2I0YjRiNCIgb3BhY2l0eT0iMSIgZGF0YS1vcmlnaW5hbD0iIzAwMDAwMCIgY2xhc3M9IiI+PC9wYXRoPjwvZz48L3N2Zz4=" alt="" />
                <h3 style="font-weight: bold; font-size: 19px; margin-bottom: 5px;">
                    <%= data.executive_summary.data[0].title %>
                </h3>
                </div>
                <% if (data.executive_summary.data[0].sub) { %>
                <% data.executive_summary.data[0].sub.forEach((i, j) => { %>
                    <p style="font-size: 19px; margin: 0; margin-bottom: 10px;">
                    <% if(i.title) { %> <strong><%= i.title %>:</strong> <% } %> <%= i.desc %>
                    </p>
                <% }); %>
                <% } %>
                <div style="display: flex; gap: 20px; margin: 5px 0;">
                <img style="width: 60px;" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB4PSIwIiB5PSIwIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTEyIDUxMiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgY2xhc3M9IiI+PGc+PHBhdGggZD0iTTk3LjkzNCAxNzEuNzM4YTggOCAwIDAgMSA0LjkyNC0xMC4xODZjOTQuODcxLTMzLjAzOCAxNzkuODkyLTc5LjI3MSAyNTMuMDIxLTEzNy41NDhMMzQyLjEyIDI0YTggOCAwIDAgMSAuMDAyLTE2aC4wMDJsMzYuMTE1LjAwOWE3Ljk5OCA3Ljk5OCAwIDAgMSA3LjgzOSA5LjU4MmwtNy4xNDIgMzUuNDAyYTguMDAzIDguMDAzIDAgMCAxLTkuNDI0IDYuMjU5IDggOCAwIDAgMS02LjI2LTkuNDI0bDIuNzAzLTEzLjM5N2MtNzQuNTY4IDU5LjQ0NS0xNjEuMjA4IDEwNi41OC0yNTcuODM3IDE0MC4yM2E3Ljk5MyA3Ljk5MyAwIDAgMS0xMC4xODQtNC45MjN6bTM4My43ODQgMjkzLjEzNGE4IDggMCAwIDEtOCA4aC04MS4xNjFhOCA4IDAgMCAxLTgtOGMwLTcwLjg4Ni01Ny42Ny0xMjguNTU3LTEyOC41NTctMTI4LjU1N3MtMTI4LjU1NyA1Ny42Ny0xMjguNTU3IDEyOC41NTdhOCA4IDAgMCAxLTggOEgzOC4yODJhOCA4IDAgMCAxLTgtOGMwLTYwLjI5MiAyMy40NzktMTE2Ljk3NCA2Ni4xMTEtMTU5LjYwNmEyMzMuMjQ1IDIzMy4yNDUgMCAwIDEgNS45NDUtNS43MTQgOC4wODYgOC4wODYgMCAwIDEtLjEwNC0xLjIzM3YtODYuNTA2YTggOCAwIDAgMSA4LThoNDUuMDkyYTggOCAwIDAgMSA4IDh2NDcuMTI1YTIyMi42OSAyMjIuNjkgMCAwIDEgMjIuNjM4LTguNzUxdi04My42OTlhOCA4IDAgMCAxIDgtOGg0NS4wOTJhOCA4IDAgMCAxIDggOHY3Mi44NTZjMi45NzMtLjExNSA1Ljk1My0uMTg5IDguOTQ0LS4xODkgNC41ODggMCA5LjE1MS4xNTMgMTMuNjkyLjQyM1YxMTkuMTZhOCA4IDAgMCAxIDgtOGg0NS4wOTJhOCA4IDAgMCAxIDggOHYxMzIuNjMyYTIyMi41NiAyMjIuNTYgMCAwIDEgMjIuNjM2IDkuMzQ5Vjc2LjU4NWE4IDggMCAwIDEgOC04aDQ1LjA5MmE4IDggMCAwIDEgOCA4djIyMS43MzNjMCAxLjY3Ni0uNTE3IDMuMjMtMS4zOTcgNC41MTUuODMzLjgwOCAxLjY3IDEuNjEgMi40OTIgMi40MzIgNDIuNjMyIDQyLjYzMiA2Ni4xMTEgOTkuMzE1IDY2LjExMSAxNTkuNjA3ek0zNjkuNDIgMjY5LjYyOGEyMjUuNTE3IDIyNS41MTcgMCAwIDEgMjkuMDkyIDIwLjE4Vjg0LjU4NUgzNjkuNDJ6bS0xNiA5LjU2NWMtMjYuOTA1LTE0LjE3NC01Ny4yNDctMjIuNjU5LTg5LjQyLTIzLjg3MnY2NS4yMjFhMTQzLjQ5NyAxNDMuNDk3IDAgMCAxIDU3LjIyNyAxNS4zNTVsMzIuMTkzLTU1Ljc2ek0yNDggMjU1LjMyMWMtMzIuMzM5IDEuMjItNjIuODMyIDkuNzgyLTg5Ljg0IDI0LjA4OWwzMi42MTMgNTYuNDg3QTE0My40OTcgMTQzLjQ5NyAwIDAgMSAyNDggMzIwLjU0MnptMzcuNjkyLTE0LjIyOWEyMjQuOTUxIDIyNC45NTEgMCAwIDEgMjkuMDkyIDUuNzY2VjEyNy4xNmgtMjkuMDkyem0tODMuNzI4IDQuNTQ1YTIyNS42NSAyMjUuNjUgMCAwIDEgMjkuMDkyLTUuMTEzdi02Ni4wMzdoLTI5LjA5MnptLTgzLjczIDQwLjQwM2EyMjQuNzYgMjI0Ljc2IDAgMCAxIDI5LjA5Mi0xOS4xMDJ2LTQ3LjEyNmgtMjkuMDkyem04Ljc4OSAxMTMuNjA1LTU2LjQ3Mi0zMi42MDRjLTE0LjMwNyAyNy4wMS0yMi44OTcgNTcuNDkxLTI0LjExOCA4OS44MzFoNjUuMjI5YTE0My41MTUgMTQzLjUxNSAwIDAgMSAxNS4zNjEtNTcuMjI3em00OS45MDYtNTUuNzI4LTMyLjYwNi01Ni40NzVhMjExLjM3OCAyMTEuMzc4IDAgMCAwLTY1Ljc1MSA2NS43NTVsNTYuNDY4IDMyLjYwMmExNDUuNzE2IDE0NS43MTYgMCAwIDEgNDEuODg5LTQxLjg4MnptMjAwLjAzMiA0MS44ODEgNTYuNDY3LTMyLjYwMmEyMTEuMzg4IDIxMS4zODggMCAwIDAtNjUuNzUxLTY1Ljc1NWwtMzIuNjA2IDU2LjQ3NWExNDUuNzU3IDE0NS43NTcgMCAwIDEgNDEuODkgNDEuODgyem04OC42MDYgNzEuMDc0Yy0xLjIyMS0zMi4zNC05LjgxMi02Mi44MjItMjQuMTE4LTg5LjgzMWwtNTYuNDcyIDMyLjYwNGExNDMuNTE5IDE0My41MTkgMCAwIDEgMTUuMzYxIDU3LjIyN3ptLTEzNi4xMDUtNjUuNDYxYTggOCAwIDAgMSAwIDExLjMxM2wtNDAuNzM2IDQwLjczNmEzOC44OSAzOC44OSAwIDAgMSA2LjQwMiAyMS40MTFDMjk1LjEyOCA0ODYuNDQ3IDI3Ny41NzUgNTA0IDI1NiA1MDRjLTIxLjU3NiAwLTM5LjEyOS0xNy41NTMtMzkuMTI5LTM5LjEyOHMxNy41NTMtMzkuMTI4IDM5LjEyOS0zOS4xMjhhMzguODkzIDM4Ljg5MyAwIDAgMSAyMS40MTIgNi40MDNsNDAuNzM2LTQwLjczNWE3Ljk5OSA3Ljk5OSAwIDAgMSAxMS4zMTQtLjAwMXptLTUwLjMzNCA3My40NjFjMC0xMi43NTMtMTAuMzc1LTIzLjEyOC0yMy4xMjgtMjMuMTI4cy0yMy4xMjkgMTAuMzc1LTIzLjEyOSAyMy4xMjhTMjQzLjI0NyA0ODggMjU2IDQ4OHMyMy4xMjgtMTAuMzc1IDIzLjEyOC0yMy4xMjh6IiBmaWxsPSIjYjRiNGI0IiBvcGFjaXR5PSIxIiBkYXRhLW9yaWdpbmFsPSIjMDAwMDAwIj48L3BhdGg+PC9nPjwvc3ZnPg==" alt="" />
                <h3 style="font-weight: bold; font-size: 19px; margin-bottom: 5px;">
                    <%= data.executive_summary.data[1].title %>
                </h3>
                </div>
                <% if (data.executive_summary.data[1].sub) { %>
                <% data.executive_summary.data[1].sub.forEach((k, l) => { %>
                    <p style="font-size: 19px; word-break: break-word; margin: 0; margin-bottom: 10px;">
                    <% if(k.title) { %> <strong><%= k.title %>:</strong> <% } %> <%= k.desc %>
                    </p>
                <% }); %>
                <% } %>
            </div>
            <div style="grid-column: span 1; text-align: justify;">
                <div style="grid-column: span 1; text-align: justify; margin-bottom: 0;">
                <div style="display: flex; gap: 20px; margin: 5px 0;">
                    <img style="width: 60px;" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB4PSIwIiB5PSIwIiB2aWV3Qm94PSIwIDAgNTEyLjAwMiA1MTIuMDAyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MTIgNTEyIiB4bWw6c3BhY2U9InByZXNlcnZlIiBjbGFzcz0iIj48Zz48cGF0aCBkPSJNMjU2LjAwMSA5Mi4wMDJjODIuODQyIDAgMTUwIDY3LjE1NyAxNTAgMTUwIDAgNTcuNTU5LTMyLjQyNSAxMDcuNTM1LTgwIDEzMi42ODZ2MjcuMzEzYzAgMTEuMDAxLTkgMjAtMjAgMjBoLTEwMGMtMTEgMC0yMC05LTIwLTIwdi0yNy4zMTNjLTQ3LjU3NS0yNS4xNTEtODAtNzUuMTI4LTgwLTEzMi42ODYgMC04Mi44NDMgNjcuMTU3LTE1MCAxNTAtMTUwek0zMDYuMDAxIDQyNy4wMDJ2NTVsLTIwIDIwaC02MGwtMjAtMjB2LTU1TTIxMS4wMDEgNDYyLjAwMmg5ME0yNTYuMDAxIDQyLjAwMlYxME0xNTYuMDAxIDY4Ljc5NyAxNDAgNDEuMDgzTTgyLjc5NiAxNDIuMDAybC0yNy43MTQtMTYuMDAxTTU2LjAwMSAyNDIuMDAySDIzLjk5OU04Mi43OTYgMzQyLjAwMmwtMjcuNzE0IDE2LjAwMU00MjkuMjA2IDM0Mi4wMDJsMjcuNzE0IDE2LjAwMU00NTYuMDAxIDI0Mi4wMDJoMzIuMDAyTTQyOS4yMDYgMTQyLjAwMmwyNy43MTQtMTYuMDAxTTM1Ni4wMDEgNjguNzk3bDE2LjAwMS0yNy43MTQiIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2Utd2lkdGg6MjAuMDAwMTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MjIuOTI1NjsiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBmaWxsPSJub25lIiBzdHJva2U9IiNiNGI0YjQiIHN0cm9rZS13aWR0aD0iMjAuMDAwMSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbWl0ZXJsaW1pdD0iMjIuOTI1NiIgZGF0YS1vcmlnaW5hbD0iIzAwMDAwMCIgb3BhY2l0eT0iMSI+PC9wYXRoPjxwYXRoIGQ9Im0zMDcuMjE5IDIzNy4wMDItMjAuMTIxIDUzLjA0OGgtNjIuMTk0bC0yMC4xMjEtNTMuMDQ4IDUxLjIxOC04MC40ODZ6TTI1Ni4wMDEgMjM3LjAwMnYtNzMuMTY5TTIyNC45MDQgMjkwLjA1bDMuMjc3IDEyOC4yMDVtNTUuNjE1Ljk5MiAzLjMwMi0xMjkuMTk3TTI4My4yMzYgMzc3LjAwMmgtNTQuNDciIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2Utd2lkdGg6MjAuMDAwMTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MjIuOTI1NjsiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBmaWxsPSJub25lIiBzdHJva2U9IiNiNGI0YjQiIHN0cm9rZS13aWR0aD0iMjAuMDAwMSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbWl0ZXJsaW1pdD0iMjIuOTI1NiIgZGF0YS1vcmlnaW5hbD0iIzAwMDAwMCIgb3BhY2l0eT0iMSI+PC9wYXRoPjxwYXRoIGQ9Ik0yNTYuMDA4IDI0Mi4wMDJoLS4wMDciIHN0eWxlPSJmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtzdHJva2Utd2lkdGg6MjkuOTk5OTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MjIuOTI1NjsiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBmaWxsPSJub25lIiBzdHJva2U9IiNiNGI0YjQiIHN0cm9rZS13aWR0aD0iMjkuOTk5OSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbWl0ZXJsaW1pdD0iMjIuOTI1NiIgZGF0YS1vcmlnaW5hbD0iIzAwMDAwMCIgb3BhY2l0eT0iMSI+PC9wYXRoPjwvZz48L3N2Zz4=" alt="" />
                    <h3 style="font-weight: bold; font-size: 19px; margin-bottom: 5px;">
                    <%= data.executive_summary.data[2].title %>
                    </h3>
                </div>
                <% if (data.executive_summary.data[2].sub) { %>
                    <% data.executive_summary.data[2].sub.forEach((m, n) => { %>
                    <p style="font-size: 19px; word-break: break-word; margin: 0; margin-bottom: 10px;">
                       <% if(m.title) { %> <strong><%= m.title %>:</strong> <% } %> <%= m.desc %>
                    </p>
                    <% }); %>
                <% } %>
                <div style="display: flex; gap: 20px; align-items: center; margin: 5px 0;">
                    <img style="width: 60px; margin-bottom: 0;" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB4PSIwIiB5PSIwIiB2aWV3Qm94PSIwIDAgNTEyIDUxMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTEyIDUxMiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgY2xhc3M9IiI+PGc+PHBhdGggZD0iTTI1MS44IDQ1MC40YTE5NC41ODEgMTk0LjU4MSAwIDAgMS00Ni4wMDctNS41NDZBMTkzLjU5MyAxOTMuNTkzIDAgMCAxIDU4LjEwNyAyNjIuMDcyYTE5NC41MDggMTk0LjUwOCAwIDAgMSAzLjQxLTQxLjY3OCAxNS4wNTggMTUuMDU4IDAgMCAxIDI5LjU3NyA1LjY3IDE2My4wNTQgMTYzLjA1NCAwIDAgMCAyMC45MiAxMTUuNzQ2IDE2My4xODkgMTYzLjE4OSAwIDAgMCAyMjQuMzYyIDU0LjU1MWM3Ni44OTItNDYuODcyIDEwMS4zNDQtMTQ3LjYxMyA1NC41MDYtMjI0LjU2OGExNjMuMTg1IDE2My4xODUgMCAwIDAtMjI0LjM2MS01NC41NTEgMTUuMDU4IDE1LjA1OCAwIDEgMS0xNS42NzYtMjUuNzE0IDE5My4zIDE5My4zIDAgMCAxIDI2NS43NjMgNjQuNjA3YzU1LjQ2NiA5MS4xMzEgMjYuNSAyMTAuNDMyLTY0LjU1NyAyNjUuOTRBMTkyLjA4OCAxOTIuMDg4IDAgMCAxIDI1MS44IDQ1MC40eiIgZmlsbD0iI2I0YjRiNCIgb3BhY2l0eT0iMSIgZGF0YS1vcmlnaW5hbD0iIzAwMDAwMCIgY2xhc3M9IiI+PC9wYXRoPjxwYXRoIGQ9Ik0yNTAuOTIxIDUwNy42QTI1MS42NDggMjUxLjY0OCAwIDAgMSA0My42MzkgMTE0LjQyNmEyNTEuMzgzIDI1MS4zODMgMCAwIDEgMjg5Ljc3Mi05Ni4zMTMgMjUyLjQ0IDI1Mi40NCAwIDAgMSA0OS4xMjcgMjMuMjA3IDE1LjA1OCAxNS4wNTggMCAwIDEtMTUuNzIxIDI1LjY4NyAyMjAuNDUzIDIyMC40NTMgMCAwIDAtMTU2LjY3MS0yOC41OTFDOTAuMjg2IDYxLjIwOSAxMS4zIDE3Ny4zNDggMzQuMDc4IDI5Ny4zMDlBMjIxLjI3MSAyMjEuMjcxIDAgMCAwIDI5Mi43NTEgNDczLjUyQzQxMi42MSA0NTAuNzI3IDQ5MS42IDMzNC41ODggNDY4LjgxOSAyMTQuNjI4YTE1LjA1NyAxNS4wNTcgMCAwIDEgMjkuNTg2LTUuNjE4IDI1MS41NSAyNTEuNTUgMCAwIDEtMjAwLjAyOCAyOTQuMSAyNTQuMDcxIDI1NC4wNzEgMCAwIDEtNDcuNDU2IDQuNDl6IiBmaWxsPSIjYjRiNGI0IiBvcGFjaXR5PSIxIiBkYXRhLW9yaWdpbmFsPSIjMDAwMDAwIiBjbGFzcz0iIj48L3BhdGg+PHBhdGggZD0iTTI1MS40NDggMzM0LjQyNiAxNjEgMjQzLjkwOGExNS4wNTcgMTUuMDU3IDAgMSAxIDIxLjMtMjEuMjg3bDY5LjE0NCA2OS4yTDM1My45ODMgMTg5LjJhMTUuMDU4IDE1LjA1OCAwIDAgMSAyMS4zIDIxLjI4N3pNNDI0Ljk2MiAxMzguNTI2YTE0Ljk5MiAxNC45OTIgMCAwIDEgLjAwNy0yMS4zTDQ4Ni4zIDU1Ljk1MWExNS4wNTggMTUuMDU4IDAgMSAxIDIxLjI4NyAyMS4zbC02MS4zMjkgNjEuMjhjLTYuMjU4IDUuOTEzLTE2LjI1OCA0LjkxMy0yMS4yOTYtLjAwNXoiIGZpbGw9IiNiNGI0YjQiIG9wYWNpdHk9IjEiIGRhdGEtb3JpZ2luYWw9IiMwMDAwMDAiIGNsYXNzPSIiPjwvcGF0aD48L2c+PC9zdmc+" alt="" />
                    <h3 style="font-weight: bold; font-size: 19px; margin-bottom: 10px;">
                    <%= data.executive_summary.data[3].title %>
                    </h3>
                </div>
                <p style="font-size: 19px; margin: 0;">
                    <%= data.executive_summary.data[3].desc %>
                </p>
                </div>
            </div>
            </div>
            <% } %>
    </div>


    <!-- Detailed summary -->
    <div class="print-page" id="<%= data.detailed_summary.id %>">
        <div>
            <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin-bottom: 0;">
            Detailed Summary
            </p>
            <p style="font-size: 19px; color: #000;">
            A total number of <strong><%= data.detailed_summary.no_of_incidents %> <%= pluralizeWithMapping(Number(data.no_of_incidents) || 0, {one: "Incident", other: "Incidents"}) %></strong> <%= pluralizeWithMapping(Number(data.detailed_summary.no_of_incidents) || 0, {one: "was", other: "were"}) %> observed during the month of <strong><%= data.detailed_summary.date %></strong>.
            </p>
        </div>
        <% if(data.detailed_summary.risk_index_chart.datasets.length > 0) { %>
        <div style="display: grid; grid-template-columns: repeat(6, 1fr);             align-items: center; justify-content: center;">
            <div style="grid-column: span 2">
            <p style="font-size: 26px; font-weight: bold; color: #090c9b; margin-bottom: 0;">
                Risk Index
            </p>
            <div style="display: flex; align-items: center; gap: 20px;">
                <div style="position: relative; width: 200px; height: 200px; margin-top: 20px;">
                <canvas id="riskIndex"></canvas>
                </div>
                <p style="font-size: 26px; font-weight: bold; color: #090c9b">
                <%= data.detailed_summary.risk_index_chart.datasets[0].data[0] %>/100
                </p>
            </div>
            </div>
            <div style="grid-column: span 4">
            <p style="font-size: 20px; font-style: italic; margin-top: 60px;">
                <%= data.detailed_summary.risk_index_text %>
            </p>
            </div>
        </div>
        <% } %>
        <div style="margin-top: 20px;">
            <ul style="list-style-type: disc; padding-left: 20;">
            <li style="font-size: 19px; margin-bottom: 1rem;">
                <strong><%= data.detailed_summary.highly_exploitable %> CVEs detected</strong> in internal assets.
            </li>
            <li style="font-size: 19px; margin-bottom: 1rem;">
                <strong><%= data.detailed_summary.incidents_closed || 0 %> <%= pluralizeWithMapping(Number(data.detailed_summary.incidents_closed) || 0, {one: "Incident", other: "Incidents"}) %></strong> Closed without customer resolution.
            </li>
            </ul>
        </div>
        <% if (data.detailed_summary.top_incidents.length > 0) { %>
        <div>
          <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b">
            Top <%= data.detailed_summary.top_incidents.length %> Incidents
            </p>
          </div>
          <table border="1" cellpadding="14" cellspacing="0" style="width: 100%; border-collapse: collapse; border-color: #c6c6c9; text-align: center;">
            <thead>
                <tr style="color: #090c9b; font-size: 19px;">
                <th>Incident Names with no of Occurrence</th>
                <th>Priority - Impact</th>
                <th>Data Source</th>
                </tr>
            </thead>
            <tbody>
                <% data.detailed_summary.top_incidents.forEach((i, j) => { %>
                <tr style="font-size: 20px;" key="<%= j %>">
                <td style="text-align: left;"><%= i.incident_name %></td>
                <td><%= i.priority_impact %></td>
                <td><%= i.data_source %></td>
                </tr>
                <% }); %>
            </tbody>
          </table>
        </div>
        <% } %>
        <div>
            <% if (data.detailed_summary.license_consumption) { %>
            <div>
                <p style="font-size: 26px; font-weight: bold; color: #090c9b; margin-bottom: 0;">
                License Consumption :
                </p>
                <p style="font-size: 19px; color: #090c9b">
                <%= data.detailed_summary.license_consumption_text %>
                </p>
            </div>
            <% } %>
            <% if (data.detailed_summary.data_consumption) { %>
            <div>
                <p style="font-size: 26px; font-weight: bold; color: #090c9b; margin-bottom: 0;">
                Data Consumption :
                </p>
                <p style="font-size: 19px; color: #090c9b">
                  <%= data.detailed_summary.license_consumption_text %>
                </p>
            </div>
            <% } %>
            </div>
    </div>

    <!-- Risk metrics -->
    <div class="print-page" id="<%= data.risk_metrics.id %>">
        <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin-bottom: 0;">
            Risk Metrics
        </p>
        <p style="font-size: 19px; color: #000;">
            Provide security risk metrics that offer an at-a-glance view of the security landscape for <strong><%= data.risk_metrics.date %></strong>.
        </p>
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b; margin-bottom: 0;">
            Last <%= data.risk_metrics.last_risk_score.no_of_months %> months risk score
            </p>
            <div style="display: flex; justify-content: center; gap: 140px; margin-top: 20px;">
            <% data.risk_metrics.last_risk_score?.charts?.forEach((chart, i) => { %>
              <% if(chart.datasets[0].data[0] > 0) { %>
            <div style="position: relative; width: 200px; height: 200px; margin-top: 20px;">
              <canvas id="riskScore<%= i %>"></canvas>
                <p style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 22px; font-weight: bold; margin: 0;">
                <%= chart.month %>
                </p>
                <p style="position: absolute; top: -10px; right: -15px; font-size: 22px; font-weight: bold; margin: 0;"><%= chart.datasets[0].data[0] %>%</p>
            </div>
            <% } %>
            <% }); %>
            </div>
        </div>
        <% if(data.risk_metrics.top_risk_incidents.visible) { %>
          <p style="font-size: 26px; font-weight: bold; color: #090c9b; margin-top: 60px; margin-bottom: 0;">
            Top Risk Vectors based on Incidents detected
            </p>
          <div class="gauge-container">
            <% data.risk_metrics.top_risk_incidents.indicators.forEach((indicator, index) => { %>
              <% if(indicator.risk_name) { %>
                <div id="gauge<%= index %>"></div>
            <% } %>
            <% }); %>
          </div>
        <% } %>
        <% if(data.risk_metrics.notes?.length> 0) { %>
        <div>
          <%- include('./partials/recommendations', { notes: data.risk_metrics.notes }) %>
        </div>
        <% } %>
    </div>

    <!-- Threat intel summary -->
    <div class="print-page" id="<%= data.threat_intel_summary.id %>">
      <div>
        <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin-bottom: 0;">
        Threat Intel Summary
        </p>
        <p style="font-size: 26px; font-weight: bold; color: #090c9b; margin-bottom: 0;">
        Count of Advisory for entire Month:
        </p>
        <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.threat_intel_summary.count_of_advisory_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: 0 auto;">
          <!-- chart -->
          <canvas style="margin-top: 10px;" id="TISHorizontalBar1"></canvas>
        </div>
        <p style="font-size: 26px; font-weight: bold; color: #090c9b; margin-bottom: 0;">
          Total IOC Sweep for the Month - <%= data.threat_intel_summary.total_ioc_sweep %>
        </p>
        <p style="font-size: 26px; font-weight: bold; color: #090c9b; margin-bottom: 0;">
          Indicators of Compromise (IOC) Match against Sweep
        </p>
      <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.threat_intel_summary.ioc_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: 0 auto;">
        <!-- chart -->
        <canvas style="margin-top: 10px;" id="horizontalBarCharts"></canvas>
      </div>
    </div>
      <div style="margin-top: 40px;">
        <% if(data.threat_intel_summary.ioc_match_details.data.length > 0) { %>
        <p style="font-size: 26px; font-weight: bold; color: #090c9b">
        Indicators of Compromise (IOC) Match Details
        </p>
        <table border="1" cellpadding="14" cellspacing="0" style="width: 100%; border-collapse: collapse; border-color: #c6c6c9; text-align: center; margin-bottom: 15px;">
          <thead>
              <tr style="color: #090c9b; font-size: 19px;">
              <th>Sr. No</th>
              <th>Advisory Name</th>
              <th>IOC Type</th>
              <th>Detail</th>
              <th>Endpoint Name/Email</th>
              </tr>
          </thead>
          <tbody>
              <% data.threat_intel_summary.ioc_match_details.data.forEach((j, k) => { %>
              <tr style="font-size: 20px; background-color: #ededed;">
              <td><%= k + 1 %>.</td>
              <td><%= j.advisory_name %></td>
              <td><%= j.ioc_type %></td>
              <td style="word-break: break-all;"><%= j.detail %></td>
              <td style="word-break: break-all;"><%= j.endpoint_name %></td>
              </tr>
              <% }); %>
          </tbody>
        </table>
        <% } %>
        <% if(data.threat_intel_summary.ioc_investigation.data.length > 0) { %>
          <table border="1" cellpadding="14" cellspacing="0" style="width: 100%; border-collapse: collapse; border-color: #c6c6c9;">
          <tbody>
            <% data.threat_intel_summary.ioc_investigation.data.forEach((l, m) => { %>
            <tr style="font-size: 20px; background-color: #ededed;">
              <td style="width: 3rem;"><%= m + 1 %>.</td>
              <td style="word-break: break-word;">
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                  <div><strong style="color: #090c9b; font-size: 19px; font-weight: 600;">Advisory Name: </strong><%= l.advisory_name %></div>
                  <div><strong style="color: #090c9b; font-size: 19px; font-weight: 600;">About Advisory: </strong><br /><%= l.about_advisory %></div>
                  <hr style="width: 100%;" />
                  <div><strong style="color: #090c9b; font-size: 19px; font-weight: 600;">Investigation Summary: </strong></div>
                  <div><strong style="color: #090c9b; font-size: 19px; font-weight: 600;">Incident No: </strong><%= l.investigation_summary.incident_no %></div>
                  <div><strong style="color: #090c9b; font-size: 19px; font-weight: 600;">Incident Overview: </strong><%= l.investigation_summary.incident_overview %></div>
                  <div><strong style="color: #090c9b; font-size: 19px; font-weight: 600;">Findings: </strong><%= l.investigation_summary.findings %></div>
                  <div><strong style="color: #090c9b; font-size: 19px; font-weight: 600;">Action Taken: </strong><%= l.investigation_summary.action_taken %></div>
                </div>
              </td>
            </tr>
            <% }); %>
          </tbody>
          </table>
          <% } %>
      </div>
      <% if(data.threat_intel_summary.notes?.length> 0) { %>
      <div>
        <%- include('./partials/recommendations', { notes: data.threat_intel_summary.notes }) %>
      </div>
      <% } %>
    </div>

    <!-- Overall incident summary -->
    <div class="print-page" id="<%= data.overall_incident_summary.id %>">
        <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin: 0;">
            Overall Incidents Summary
        </p>
        <div style="width: 700px; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.overall_incident_summary.incidents_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: auto">
            <canvas style="margin-top: 10px" id="horizontalBarCharts2"></canvas>
        </div>
        <!-- p1 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
              P1 - Critical Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                <%= data.overall_incident_summary.p1.total_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.overall_incident_summary.p1.closed_with_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.overall_incident_summary.p1.closed_without_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.overall_incident_summary.p1.pending_with_customer.pending_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.overall_incident_summary.p1.pending_with_soc_team %>
              </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Total <br /> Incidents
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed with Resolution
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed without Acknowledgment
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with <%= data.monthly_report.customer_name %>
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with SOC Team
              </div>
            </div>
        </div>
        <!-- p2 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b">
                P2 - High Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
                <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                  <%= data.overall_incident_summary.p2.total_incidents %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p2.closed_with_resolution %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p2.closed_without_resolution %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p2.pending_with_customer.pending_incidents %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p2.pending_with_soc_team %>
                </div>
              </div>
              <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
                <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Total <br /> Incidents
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Incidents Closed with Resolution
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Incidents Closed without Acknowledgment
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Pending Incidents with <%= data.monthly_report.customer_name %>
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Pending Incidents with SOC Team
                </div>
              </div>
              
        </div>
        <!-- p3 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b">
                P3- Medium Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
                <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                  <%= data.overall_incident_summary.p3.total_incidents %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p3.closed_with_resolution %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p3.closed_without_resolution %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p3.pending_with_customer.pending_incidents %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p3.pending_with_soc_team %>
                </div>
              </div>
              <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
                <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Total <br /> Incidents
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Incidents Closed with Resolution
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Incidents Closed without Acknowledgment
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Pending Incidents with <%= data.monthly_report.customer_name %>
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Pending Incidents with SOC Team
                </div>
              </div>
              
        </div>
        <!-- p4 -->
          <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b">
                P4 – Low Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
                <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                  <%= data.overall_incident_summary.p4.total_incidents %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p4.closed_with_resolution %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p4.closed_without_resolution %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p4.pending_with_customer.pending_incidents %>
                </div>
                <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                  <%= data.overall_incident_summary.p4.pending_with_soc_team %>
                </div>
              </div>
              <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
                <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Total <br /> Incidents
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Incidents Closed with Resolution
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Incidents Closed without Acknowledgment
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Pending Incidents with <%= data.monthly_report.customer_name %>
                </div>
                <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                  Pending Incidents with SOC Team
                </div>
              </div>
              
          </div>
          
    </div>

    <!-- workbench incident summary -->
     <% if(data.workbench_incident_summary.visible) { %>
    <div class="print-page" id="<%= data.workbench_incident_summary.id %>">
        <p style="font-size: 4rem;font-weight: 700;color: #090c9b;margin-bottom: 0px;">
            Vision One Workbench Incidents Summary
        </p>
        <!-- p1 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
            P1 - Critical Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
            <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                <%= data.workbench_incident_summary.p1.total_incidents %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p1.closed_with_resolution %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p1.closed_without_resolution %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p1.pending_with_customer.pending_incidents %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p1.pending_with_soc_team %>
            </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
            <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Total <br /> Incidents
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed with Resolution
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed without Acknowledgment
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with <%= data.monthly_report.customer_name %>
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with SOC Team
            </div>
            </div>
        </div>
        <!-- p2 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
            P2 - High Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
            <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                <%= data.workbench_incident_summary.p2.total_incidents %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p2.closed_with_resolution %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p2.closed_without_resolution %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p2.pending_with_customer.pending_incidents %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p2.pending_with_soc_team %>
            </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
            <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Total <br /> Incidents
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed with Resolution
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed without Acknowledgment
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with <%= data.monthly_report.customer_name %>
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with SOC Team
            </div>
            </div>
        </div>
        <!-- p3 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
            P3- Medium Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
            <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                <%= data.workbench_incident_summary.p3.total_incidents %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p3.closed_with_resolution %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p3.closed_without_resolution %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p3.pending_with_customer.pending_incidents %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p3.pending_with_soc_team %>
            </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
            <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Total <br /> Incidents
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed with Resolution
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed without Acknowledgment
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with <%= data.monthly_report.customer_name %>
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with SOC Team
            </div>
            </div>
        </div>
        <!-- p4 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
            P4 – Low Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
            <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                <%= data.workbench_incident_summary.p4.total_incidents %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p4.closed_with_resolution %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p4.closed_without_resolution %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p4.pending_with_customer.pending_incidents %>
            </div>
            <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.workbench_incident_summary.p4.pending_with_soc_team %>
            </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
            <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Total <br /> Incidents
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed with Resolution
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed without Acknowledgment
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with <%= data.monthly_report.customer_name %>
            </div>
            <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with SOC Team
            </div>
            </div>
        </div>     
    </div>
    <% } %>
    <!-- SIEM incident summary -->
     <% if(data.siem_incident_summary.visible) { %>
    <div class="print-page" id="<%= data.siem_incident_summary.id %>">
        <p style="font-size: 4rem;font-weight: 700;color: #090c9b;margin-bottom: 0px;">
        Third Party / SIEM
        <br />
        Incidents Summary
        </p>
        <!-- p1 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
              P1 - Critical Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                <%= data.siem_incident_summary.p1.total_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p1.closed_with_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p1.closed_without_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p1.pending_with_customer.pending_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p1.pending_with_soc_team %>
              </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Total <br /> Incidents
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed with Resolution
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed without Acknowledgment
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with <%= data.monthly_report.customer_name %>
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with SOC Team
              </div>
            </div>
        </div>
        <!-- p2 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
              P2 - High Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                <%= data.siem_incident_summary.p2.total_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p2.closed_with_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p2.closed_without_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p2.pending_with_customer.pending_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p2.pending_with_soc_team %>
              </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Total <br /> Incidents
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed with Resolution
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed without Acknowledgment
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with <%= data.monthly_report.customer_name %>
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with SOC Team
              </div>
            </div>
        </div>
        <!-- p3 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
              P3- Medium Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                <%= data.siem_incident_summary.p3.total_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p3.closed_with_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p3.closed_without_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p3.pending_with_customer.pending_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p3.pending_with_soc_team %>
              </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Total <br /> Incidents
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed with Resolution
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed without Acknowledgment
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with <%= data.monthly_report.customer_name %>
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with SOC Team
              </div>
            </div>
        </div>
        <!-- p4 -->
        <div>
            <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
              P4 – Low Severity Incidents
            </p>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="font-size: 54px; font-weight: bold; color: #090c9b;">
                <%= data.siem_incident_summary.p4.total_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p4.closed_with_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p4.closed_without_resolution %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p4.pending_with_customer.pending_incidents %>
              </div>
              <div style="font-size: 54px; font-weight: 500; color: #6b6c86;">
                <%= data.siem_incident_summary.p4.pending_with_soc_team %>
              </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 0; align-items: center; justify-content: center; text-align: center;">
              <div style="background-color: #ededed; font-size: 18px; font-weight: bold; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Total <br /> Incidents
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed with Resolution
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Incidents Closed without Acknowledgment
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-right: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with <%= data.monthly_report.customer_name %>
              </div>
              <div style="font-size: 18px; font-weight: bold; color: #090c9b; border: 2px dashed #090c9b; border-left: none; box-sizing: border-box; padding: 20px 10px; height: 115px; display: grid; place-items: center;">
                Pending Incidents with SOC Team
              </div>
            </div>
        </div>
    </div>
    <% } %>
    <!-- High incident summary -->
     <% if(data.high_incident_summary.data.length > 0) { %>
    <div class="print-page" id="<%= data.high_incident_summary.id %>">
        <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin-bottom: 0;">
          Critical/High Incidents Summary
        </p>
        <table border="1" cellpadding="14" cellspacing="0" style="margin-top: 24px; width: 100%; border-collapse: collapse; border-color: #c6c6c9; text-align: center;">
          <thead>
            <tr style="color: #090c9b; font-size: 19px;">
              <th>Priority</th>
              <th style="white-space: nowrap;">Incident Title</th>
              <th>Findings and Actioned Performed</th>
            </tr>
          </thead>
          <tbody>
            <% data.high_incident_summary.data.forEach((item, i) => { %>
            <tr style="font-size: 20px;">
              <td><%= item.priority %></td>
              <td style="text-align: start;"><%= item.incident_title %></td>
              <td>
                <ul style="text-align: justify; margin-right: 10px; word-break: break-word;">
                  <li style="margin-bottom: 1rem;">
                    Overview: <%= item.findings.overview %>
                  </li>
                  <li style="margin-bottom: 1rem;">
                    Endpoint Host Name: <%= item.findings.endpoint_host_name %>
                  </li>
                  <li style="margin-bottom: 1rem;">
                    Detected By: <%= item.findings.detected_by %>
                  </li>
                  <li style="margin-bottom: 1rem;">
                    Action Performed: <%= item.findings.action_performed %>
                  </li>
                </ul>
              </td>
            </tr>
            <% }); %>
          </tbody>
        </table>
        <div>
          <%- include('./partials/recommendations', { notes: data.high_incident_summary.notes }) %>
        </div>
    </div>
    <% } %>

    <!-- pending incident summary -->
    <% if(data.pending_incident_summary.data.length > 0 ) { %>
    <div class="print-page" id="<%= data.pending_incident_summary.id %>">
        <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin-bottom: 0;">
          Pending Incidents Summary
        </p>
        <table border="1" cellpadding="20" cellspacing="0" style="margin-top: 24px; width: 100%; border-collapse: collapse; border-color: #c6c6c9; text-align: center;">
          <thead>
            <tr style="color: #090c9b; font-size: 19px;">
              <th>Incident Names</th>
              <th style="white-space: nowrap;">Priority</th>
              <th>No of Occurrence</th>
              <th>Severity</th>
            </tr>
          </thead>
          <tbody>
            <% data.pending_incident_summary.data.forEach((item, i) => { %>
            <tr style="font-size: 20px;" key="<%= i %>">
              <td style="text-align: start;"><%= item.incident_name %></td>
              <td><%= item.priority %></td>
              <td><%= item.no_of_occurrence %></td>
              <td><%= item.severity %></td>
            </tr>
            <% }); %>
          </tbody>
        </table>
    </div>
    <% } %>

    <!-- SLO summary -->
    <div class="print-page" id="<%= data.slo_summary.id %>">
        <p style="font-size: 4rem; font-weight: 700; color: #090c9b;">
          SLO Summary
        </p>
        <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.slo_summary.slo_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: 0 auto;">
            <canvas style="margin-top: 10px" id="horizontalBarCharts3"></canvas>
          </div>
        <div>
          <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
            Service Level Objective (SLO)
          </p>
          <div>
            <table border="1" cellpadding="20" cellspacing="0" style="margin-top: 24px; width: 100%; border-collapse: collapse; border-color: #c6c6c9; text-align: center;">
              <thead>
                <tr style="color: #090c9b; font-size: 19px;">
                  <th>Priority</th>
                  <th>Description</th>
                  <th style="white-space: nowrap;">Response Time</th>
                </tr>
              </thead>
              <tbody>
                <% data.slo_summary.slo_table.forEach((item, i) => { %>
                <tr style="font-size: 20px;" key="<%= i %>">
                  <td><%= item.priority %></td>
                  <td style="text-align: start;"><%= item.description %></td>
                  <td><%= item.response_time %></td>
                </tr>
                <% }); %>
              </tbody>
            </table>
          </div>
        </div>
    </div>

    <!-- detection summary from apexone -->
     <% if(data.detection_summary_apex_one.visible) { %>
    <div class="print-page" id="<%= data.detection_summary_apex_one.id %>">
        <div>
            <p style="font-size: 4rem; font-weight: 700; color: #090c9b;">
              Detection Summary from Apex One as a Service / Std Endpoint Protection
            </p>
            <div>
              <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
                Virus / Malware and Spyware / Grayware
              </p>
              <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.detection_summary_apex_one.detection_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: 0 auto;">
                <canvas style="margin-top: 10px" id="horizontalBarCharts4"></canvas>
              </div>
            </div>
            <div>
              <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
                C &amp; C Connections and Intrusion attempts Blocked
              </p>
              <div style="width: 70%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.detection_summary_apex_one.attempts_blocked_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: 0 auto;">
                <canvas style="margin-top: 10px" id="horizontalBarCharts5"></canvas>
              </div>
            </div>
        </div>
        <div style="display: flex; align-items: center; justify-content: center; margin-top: 40px; gap: 20px;">
          <% if(data.detection_summary_apex_one.tables.table1.length > 0) { %>
            <div style="margin-top: 24px; padding-bottom: 22px;">
              <table border="1" cellpadding="14" cellspacing="0" style="width: 100%; border-collapse: collapse; border-color: #c6c6c9; text-align: center;">
                <thead>
                  <tr style="color: #090c9b; font-size: 19px;">
                    <th>Top Endpoints File Cleaned</th>
                    <th>Top Endpoints File Quarantined</th>
                    <th>Top Endpoints File Deleted</th>
                  </tr>
                </thead>
                <tbody>
                  <% data.detection_summary_apex_one.tables.table1.forEach((item, i) => { %>
                  <tr style="font-size: 20px;" key="<%= i %>">
                    <td><%= item.file_cleaned %> (<%= item.fc_v || 0 %>)</td>
                    <td><%= item.file_quarantined %> (<%= item.fq_v || 0 %>)</td>
                    <td><%= item.file_deleted %> (<%= item.fd_v || 0 %>)</td>
                  </tr>
                  <% }); %>
                </tbody>
              </table>
            </div>
          <% } %>
          <% if(data.detection_summary_apex_one.tables.table2.length > 0) { %>
            <div style="width: 100%; height: 100%;">
              <table border="1" cellpadding="14" cellspacing="0" style="width: 100%; border-collapse: collapse; border-color: #c6c6c9; text-align: center;">
                <thead>
                  <tr style="color: #090c9b; font-size: 19px;">
                    <th>
                      Top Endpoints Intrusion <br />
                      Attempts Blocked
                    </th>
                    <th>Top Endpoints C &amp; C Connection Blocked</th>
                  </tr>
                </thead>
                <tbody>
                  <% data.detection_summary_apex_one.tables.table2.forEach((item, i) => { %>
                  <tr style="font-size: 20px;" key="<%= i %>">
                    <td>
                      <%= item.attempts_blocked.endpoint %> (<%= item.attempts_blocked.blocked %>)
                    </td>
                    <td>
                      <%= item.connection_endpoint.endpoint %> (<%= item.connection_endpoint.blocked %>)
                    </td>
                  </tr>
                  <% }); %>
                </tbody>
              </table>
            </div>
          <% } %>
        </div>                    
    </div>
    <% } %>
      
    <!-- Email quarantine summary -->
    <% if(data.email_quarantine_summary_cas.visible) { %>
    <div class="print-page" id="<%= data.email_quarantine_summary_cas.id %>">
        <p style="font-size: 4rem; font-weight: 700; color: #090c9b;">
          Email Quarantine <br />
          Summary from CAS
        </p>
        <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.email_quarantine_summary_cas.status_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: auto;">
            <canvas style="margin-top: 10px;" id="horizontalBarCharts6"></canvas>
        </div>
        <div style="margin-top: 40px;">
          <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
            Top Sender and Receipts
          </p>
        </div>
        <div style="margin-top: 40px;">
          <table border="1" cellpadding="14" cellspacing="0" style="width: 100%; border-collapse: collapse; border-color: #c6c6c9; text-align: start;">
            <thead>
              <tr style="color: #090c9b; font-size: 19px;">
                <th>Top Sender</th>
                <th>Top Receipts</th>
              </tr>
            </thead>
            <tbody>
              <tr style="font-size: 20px;">
                <td width="500">
                  <p style="margin: 0; line-height: 1.3; word-break: break-word;"><%= data.email_quarantine_summary_cas.sender_receipts.sender %></p>
                </td>
                <td width="500">
                  <p style="margin: 0; line-height: 1.3; word-break: break-word;"><%= data.email_quarantine_summary_cas.sender_receipts.receipt %></p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div style="margin-top: 40px;">
          <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
            Threat Type
          </p>
          <table border="1" cellpadding="14" cellspacing="0" style="width: 100%; border-collapse: collapse; border-color: #c6c6c9; text-align: center;">
            <thead>
              <tr style="color: #090c9b; font-size: 19px;">
                <th>Malicious Files</th>
                <th>Malicious URLs</th>
                <th>Phishing</th>
                <th>Spoofing</th>
                <th>Suspicious Object</th>
                <th>Blocked Object</th>
              </tr>
            </thead>
            <tbody>
              <tr style="font-size: 20px;">
                <td><%= data.email_quarantine_summary_cas.threat_type.malicious_files %></td>
                <td><%= data.email_quarantine_summary_cas.threat_type.malicious_urls %></td>
                <td><%= data.email_quarantine_summary_cas.threat_type.phishing %></td>
                <td><%= data.email_quarantine_summary_cas.threat_type.spoofing %></td>
                <td><%= data.email_quarantine_summary_cas.threat_type.suspicious_objects %></td>
                <td><%= data.email_quarantine_summary_cas.threat_type.blocked_objects %></td>
              </tr>
            </tbody>
          </table>
        </div>
        <% if(data.email_quarantine_summary_cas.notes?.length> 0) { %>
        <div>
          <%- include('./partials/recommendations', { notes: data.email_quarantine_summary_cas.notes }) %>
        </div>
        <% } %>
    </div>
    <% } %>

    <!-- vulnerability assessment -->
    <div class="print-page" id="<%= data.vulnerability_assessment_report.id %>">
      <div class="margin-top:40px">
          <p style="font-size: 4rem; font-weight: 700; color: #090c9b;">
              Vulnerability Assessment <br />
              Report
          </p>
          <div style="margin: auto;">
              <table style="width: 100%; border-collapse: collapse;">
                <thead>
                  <tr style="background-color: #090c9b; color: white;">
                    <th style="padding: 22px; text-align: left; font-size: 20px; width: 40%;">
                      Internal Assets
                    </th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                      Vulnerable Endpoint Percentage
                    </td>
                    <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                      <%= data.vulnerability_assessment_report.internal_assets.vulnerable_endpoint %><br />
                      <span style="font-weight: normal;">
                        of your endpoints contain CVEs
                      </span>
                    </td>
                  </tr>
                  <tr>
                    <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                      CVE Density
                    </td>
                    <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                      <%= data.vulnerability_assessment_report.internal_assets.highly_exploitable_cve %>
                      <br />
                      <span style="font-weight: normal;">
                        CVEs per endpoint
                      </span>
                    </td>
                  </tr>
                  <tr>
                    <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                      Devices with Legacy Windows Systems
                    </td>
                    <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                      <%= data.vulnerability_assessment_report.internal_assets.devices_with_windows_legacy %>
                      <br />
                      <span style="font-weight: normal;">
                        Devices with legacy Windows systems
                      </span>
                    </td>
                  </tr>
                  <tr>
                    <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                      Average Unpatched Time
                    </td>
                    <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                      <%= data.vulnerability_assessment_report.internal_assets.average_unpatched_time %>
                      <br />
                      <span style="font-weight: normal;">
                        on average that CVEs remain unpatched
                      </span>
                    </td>
                  </tr>
                  <tr>
                    <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                      Mean Time to Patch (MTTP)
                    </td>
                    <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                      
                      <%= data.vulnerability_assessment_report.internal_assets.mttp %>
                      <br />
                      <span style="font-weight: normal;">on average to patch CVEs</span>
                    </td>
                  </tr>
                  <tr>
                    <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                      Detected Vulnerabilities
                    </td>
                    <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                      <%= data.vulnerability_assessment_report.internal_assets.highly_exploitable_unique_cve %>
                      <br />
                      <span style="font-weight: normal;">
                        CVEs detected
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
          </div>
          <div style="margin: auto; margin-top: 40px;">
              <table style="width: 100%; border-collapse: collapse;">
              <thead>
                  <tr style="background-color: #090c9b; color: white;">
                  <th colspan="2" style="padding: 22px; text-align: left; font-size: 20px;">
                      Internet-Facing Assets
                  </th>
                  </tr>
              </thead>
              <tbody>
                  <tr>
                  <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                    Detected Vulnerabilities
                  </td>
                  <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                      <%= data.vulnerability_assessment_report.internet_facing_assets.unique_cve %>
                      <br />
                      <span style="font-weight: normal;">
                        CVEs detected in hosts
                      </span>
                  </td>
                  </tr>
                  <tr>
                  <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                      Vulnerable Host Percentage
                  </td>
                  <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                      <%= data.vulnerability_assessment_report.internet_facing_assets.vulnerable_host %><br />
                      <span style="font-weight: normal;">
                      of your hosts have highly-exploitable CVE
                      </span>
                  </td>
                  </tr>
                  <tr>
                  <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                      Highly Exploitable CVE Density of Hosts
                  </td>
                  <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                      <%= data.vulnerability_assessment_report.internet_facing_assets.cve_density %>
                      <br />
                      <span style="font-weight: normal;">
                      Highly-exploitable CVE density of hosts
                      </span>
                  </td>
                  </tr>
              </tbody>
              </table>
          </div>
          <% if(data.vulnerability_assessment_report.notes?.length> 0) { %>
          <div>
            <%- include('./partials/recommendations', { notes: data.vulnerability_assessment_report.notes }) %>
          </div>
          <% } %>
      </div>
    </div>

    <!-- system configuration report -->
    <div class="print-page" id="<%= data.system_configuration_report.id %>">
      <div>
        <p style="margin-top: 40px; font-size: 4rem; font-weight: 700; color: #090c9b;">
          System Configuration Report
        </p>
        <div style="margin: auto;">
          <table style="width: 100%; border-collapse: collapse;">
            <thead>
              <tr style="background-color: #090c9b; color: white;">
                <th style="padding: 24; width: 40%; text-align: left; text-transform: uppercase;">Internal Assets</th>
                <th style="padding: 24;"></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                  ACCOUNTS WITH WEAK AUTHENTICATION
                </td>
                <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                  <%= data.system_configuration_report.accounts_with_weak_auth %><br />
                  <span style="font-weight: normal;">
                    of your Accounts have weak authentication.
                  </span>
                </td>
              </tr>
              <tr>
                <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                  ACCOUNTS THAT INCREASE ATTACK SURFACE RISK
                </td>
                <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                  <%= data.system_configuration_report.account_attack_surface_risk %><br />
                  <span style="font-weight: normal;">
                    of your accounts increases the attack surface risk
                  </span>
                </td>
              </tr>
              <tr>
                <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                  ACCOUNTS WITH EXCESSIVE PRIVILEGE
                </td>
                <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                  <%= data.system_configuration_report.accounts_with_excessive_privilege %><br />
                  <span style="font-weight: normal;">
                    of your accounts have excessive privilege
                  </span>
                </td>
              </tr>
              <tr>
                <td style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;">
                  LEGACY AUTHENTICATION PROTOCOL WITH LOG ON ACTIVITY
                </td>
                <td style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;">
                  <%= data.system_configuration_report.legacy_auth_logon_activity %><br />
                  <span style="font-weight: normal;">
                    Log on activity from legacy authentication protocols
                  </span>
                </td>
              </tr>
              <tr>
                <td
                  style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;"
                  rowspan="2"
                >
                  UNEXPECTED INTERNET-FACING SERVICES/PORTS
                </td>
                <td
                  style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;"
                >
                  <%= data.system_configuration_report.unexpected_internet_facing_serve_port.service_port %><br />
                  <span style="font-weight: normal;">
                    Unique unexpected services/ports
                  </span>
                </td>
              </tr>
              <tr>
                <td
                  style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;"
                >
                  <%= data.system_configuration_report.unexpected_internet_facing_serve_port.affected_ip %><br />
                  <span style="font-weight: normal;">
                    Total public IPs affected
                  </span>
                </td>
              </tr>
              <tr>
                <td
                  style="background-color: #d9e2f1; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; color: #090c9b; font-weight: bold;"
                  rowspan="2"
                >
                  HOSTS WITH INSECURE CONNECTION ISSUES
                </td>
                <td
                  style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;"
                >
                  <%= data.system_configuration_report.host_with_insecure_connection.insecure_connection %><br />
                  <span style="font-weight: normal;">
                    Hosts with insecure connection issues
                  </span>
                </td>
              </tr>
              <tr>
                <td
                  style="background-color: #f4f6fb; border-bottom: 1px solid #090c9b; padding: 16px; font-size: 20px; font-weight: bold;"
                >
                  <%= data.system_configuration_report.host_with_insecure_connection.total %><br />
                  <span style="font-weight: normal;">
                    Total connection issues
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <% if(data.system_configuration_report.notes?.length> 0) { %>
      <div>
        <%- include('./partials/recommendations', { notes: data.system_configuration_report.notes }) %>
      </div>
      <% } %>
    </div>
    
    <!-- top vulnerabilities -->
    <div class="print-page" id="<%= data.top_vulnerabilities_detected.id %>">
        <div>
            <p style="margin-top: 40px; font-size: 4rem; font-weight: 700; color: #090c9b;">
              Top Vulnerabilities <br />
              Detected
            </p>
            <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.top_vulnerabilities_detected.impact_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: 0 auto;">
              <!-- horizontal bar chart -->
              <canvas style="margin-top: 10px;" id="horizontalBarCharts7"></canvas>
            </div>
            <% if(data.top_vulnerabilities_detected.notes?.length> 0) { %>
            <div>
              <%- include('./partials/recommendations', { notes: data.top_vulnerabilities_detected.notes }) %>
            </div>
            <% } %>
        </div>
    </div>

    <!-- top risk device -->
    <% if(data.top_risk_device.visible) { %>
    <div class="print-page" id="<%= data.top_risk_device.id %>">
        <div>
            <p style="margin-top: 40px; font-size: 4rem; font-weight: 700; color: #090c9b;">
              Top Risk Devices
            </p>
            <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.top_risk_device.risk_score_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: 0 auto;">
              <!-- horizontal bar chart -->
              <canvas style="margin-top: 10px;" id="horizontalBarCharts8"></canvas>
            </div>
            <% if(data.top_risk_device.notes?.length> 0) { %>
            <div>
              <%- include('./partials/recommendations', { notes: data.top_risk_device.notes }) %>
            </div>
            <% } %>
        </div>
    </div>
    <% } %>

    <!-- top risk user -->
    <% if(data.top_risk_users.visible) { %>
    <div class="print-page" id="<%= data.top_risk_users.id %>">
        <div>
            <p style="margin-top: 40px; font-size: 4rem; font-weight: 700; color: #090c9b;">
              Top Risk Users
            </p>
            <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.top_risk_users.risk_score_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: auto;">
              <!-- horizontal bar chart -->
              <canvas style="margin-top: 10px;" id="horizontalBarCharts9"></canvas>
            </div>
            <% if(data.top_risk_users.notes?.length> 0) { %>
            <div>
              <%- include('./partials/recommendations', { notes: data.top_risk_users.notes }) %>
            </div>
            <% } %>
        </div>
    </div>
    <% } %>

    <!-- account compromise events -->
    <% if(data.account_compromise_events.visible) { %>
    <div class="print-page" id="<%= data.account_compromise_events.id %>">
      <div>
        <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin-bottom: 0;">
          Account Compromise Events
        </p>
        <div>
          <div>
            <table
              border="1"
              cellpadding="14"
              cellspacing="0"
              style="
                margin-top: 24px;
                width: 100%;
                border-collapse: collapse;
                border-color: #c6c6c9;
                text-align: center;
              "
            >
              <thead>
                <tr style="color: #090c9b; font-size: 19px;">
                  <th>Risk Event</th>
                  <th>Data Source</th>
                  <th style="white-space: nowrap">Asset</th>
                  <th>Event Risk</th>
                </tr>
              </thead>
              <tbody style="text-align: start;">
                <% data.account_compromise_events.risk_event_table.forEach((item, index) => { %>
                <tr style="font-size: 20px;" key="<%= index %>">
                  <td><%= item.risk_event %></td>
                  <td style="text-align: start;"><%= item.data_source %></td>
                  <td><%= item.asset %></td>
                  <td><%= item.event_risk %></td>
                </tr>
                <% }); %>
              </tbody>
            </table>
          </div>
          <% if(data.account_compromise_events.notes?.length> 0) { %>
          <div>
            <%- include('./partials/recommendations', { notes: data.account_compromise_events.notes }) %>
          </div>
          <% } %>
        </div>
      </div>          
    </div>
    <% } %>

    <!-- product assessment report -->
    <div class="print-page" id="<%= data.product_assessment_report.id %>">
        <div>
            <p style="font-size: 4rem; font-weight: 700; color: #090c9b; margin-bottom: 0;">
              Product Assessment <br />
              Report
            </p>
            <% if(data.product_assessment_report.tm_products_summary.length > 0) { %>
            <div>
              <p style="font-size: 26px; font-weight: bold; color: #090c9b;">
                Products Integrated
              </p>
              <div>
                <table
                  border="1"
                  cellpadding="14"
                  cellspacing="0"
                  style="
                    margin-top: 24px;
                    width: 100%;
                    border-collapse: collapse;
                    border-color: #c6c6c9;
                    text-align: center;
                  "
                >
                  <thead>
                    <tr style="color: #090c9b; font-size: 19px;">
                      <th>TM Product</th>
                      <th>
                        Connection <br />
                        status
                      </th>
                      <th style="white-space: nowrap">Identifier</th>
                    </tr>
                  </thead>
                  <tbody style="text-align: start;">
                    <% data.product_assessment_report.tm_products_summary.forEach((item, index) => { %>
                    <tr style="font-size: 20px;" key="<%= index %>">
                      <td><%= item.tm_product %></td>
                      <td style="text-align: start;"><%= item.connection_status %></td>
                      <td><%= item.identifier %></td>
                    </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
            </div>
            <% } %>
            <% if(data.product_assessment_report.integration_summary.length > 0) { %>
            <div>
              <p style="font-size: 26px; font-weight: bold; color: #090c9b; margin-bottom: 0;">
                Third Party Products Integrated
              </p>
              <div>
                <table
                  border="1"
                  cellpadding="14"
                  cellspacing="0"
                  style="
                    margin-top: 24px;
                    width: 100%;
                    border-collapse: collapse;
                    border-color: #c6c6c9;
                    text-align: center;
                  "
                >
                  <thead>
                    <tr style="color: #090c9b; font-size: 19px;">
                      <th>Product</th>
                      <th>Status</th>
                      <th>Product Quantity as per SOW</th>
                      <th>Integrated Devices / Log Receiving Status</th>
                      <th>Data Consumption</th>
                    </tr>
                  </thead>
                  <tbody style="text-align: start;">
                    <% data.product_assessment_report.integration_summary.forEach((item, index) => { %>
                    <tr style="font-size: 20px;" key="<%= index %>">
                      <td style="white-space: nowrap"><%= item.product %></td>
                      <td style="text-align: start;"><%= item.status %></td>
                      <td><%= item.product_quantity_sow %></td>
                      <td><%= item.id_log_status %></td>
                      <td><%= item.data_consumption %></td>
                    </tr>
                    <% }); %>
                  </tbody>
                </table>
              </div>
            </div>
            <% } %>
            <% if(data.product_assessment_report.notes?.length > 0) { %>
              <%- include('./partials/recommendations', { notes: data.product_assessment_report.notes }) %>
            <% } %>
        </div> 
    </div>

    <!-- endpoint compliance feature -->
    <div class="print-page" id="<%= data.endpoint_feature_compliance.id %>">
      <div>
        <p style="font-size: 4rem; font-weight: 700; color: #090c9b;">
          Endpoint Feature Compliance
        </p>
        <div style="width: 800px; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.endpoint_feature_compliance.compliance_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: 0 auto;">
          <!-- horizontal bar chart -->
          <canvas style="margin-top: 10px;" id="horizontalBarCharts10"></canvas>
        </div>
        <% if(data.endpoint_feature_compliance.notes?.length> 0) { %>
        <div>
          <%- include('./partials/recommendations', { notes: data.endpoint_feature_compliance.notes }) %>
        </div>
        <% } %>
      </div>
    </div>

    <!-- key feature adoption apex one -->
    <% if(data.key_feature_adoption_apex_one.visible) { %>
    <div class="print-page" id="<%= data.key_feature_adoption_apex_one.id %>">
        <div>
            <p
              style="
                font-size: 4rem;
                font-weight: 700;
                color: #090c9b;
                margin-bottom: 0px;
              "
            >
              Key Feature Adoption Rate of Apex one as Service / Std Endpoint Protection
            </p>
            <div style="display: flex; justify-content: center;">
              <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.key_feature_adoption_apex_one.apex_one_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: auto">
                <canvas style="margin-top: 10px" id="myChart"></canvas>
              </div>
              <!-- <div style="width: 25%; margin-top: 24px">
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 95.5%">95.5%</div>
                </div>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 18.1%">18.1%</div>
                </div>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 89.6%">89.6%</div>
                </div>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 70.7%">70.7%</div>
                </div>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 67.7%">67.7%</div>
                </div>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 95.7%">95.7%</div>
                </div>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 0%">0%</div>
                </div>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 95.5%">95.5%</div>
                </div>
              </div> -->
            </div>
            <% if(data.key_feature_adoption_apex_one.notes?.length> 0) { %>
            <div>
              <%- include('./partials/recommendations', { notes: data.key_feature_adoption_apex_one.notes }) %>
            </div>
            <% } %>
        </div>
    </div>
    <% } %>
      
      <!-- key feature adoption workload security -->
      <% if(data.key_feature_adoption_server_workload.visible) { %>
      <div class="print-page" id="<%= data.key_feature_adoption_server_workload.id %>">
          <div>
              <p
                style="
                  font-size: 4rem;
                  font-weight: 700;
                  color: #090c9b;
                  margin-bottom: 0px;
                "
              >
              Key feature adoption rate of C1WS / Server & Workload Security / Protection
              </p>
              <div style="display: flex; justify-content: center;">
                <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.key_feature_adoption_server_workload.workload_security_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: 0 auto">
                  <canvas style="margin-top: 10px" id="myChart2"></canvas>
                </div>
                <!-- <div style="width: 25%; margin-top: 24px">
                  <div class="progress-bar-container">
                    <div class="progress-bar" style="width: 95.5%">95.5%</div>
                  </div>
                  <div class="progress-bar-container">
                    <div class="progress-bar" style="width: 18.1%">18.1%</div>
                  </div>
                  <div class="progress-bar-container">
                    <div class="progress-bar" style="width: 89.6%">89.6%</div>
                  </div>
                  <div class="progress-bar-container">
                    <div class="progress-bar" style="width: 70.7%">70.7%</div>
                  </div>
                  <div class="progress-bar-container">
                    <div class="progress-bar" style="width: 67.7%">67.7%</div>
                  </div>
                  <div class="progress-bar-container">
                    <div class="progress-bar" style="width: 95.7%">95.7%</div>
                  </div>
                  <div class="progress-bar-container">
                    <div class="progress-bar" style="width: 0%">0%</div>
                  </div>
                  <div class="progress-bar-container">
                    <div class="progress-bar" style="width: 95.5%">95.5%</div>
                  </div>
                </div> -->
              </div>
              <% if(data.key_feature_adoption_server_workload.notes?.length> 0) { %>
              <div>
                <%- include('./partials/recommendations', { notes: data.key_feature_adoption_server_workload.notes }) %>
              </div>
              <% } %>
          </div>
      </div>
      <% } %>

    <!-- key feature adoption deep security -->
    <% if(data.key_feature_adoption_deep_security.visible) { %>
    <div class="print-page" id="<%= data.key_feature_adoption_deep_security.id %>">
      <div>
          <p
            style="
              font-size: 4rem;
              font-weight: 700;
              color: #090c9b;
              margin-bottom: 0px;
            "
          >
          Key Feature Adoption Rate of Deep Security
          </p>
          <div style="display: flex; justify-content: center;">
            <div style="width: 80%; height: <%- Math.min( CHART_EXTRAS.LEGEND_HEIGHT + data.key_feature_adoption_deep_security.deep_security_chart.key.length * CHART_EXTRAS.HEIGHT_PER_KEY, 1000) %>px; margin: auto">
              <canvas style="margin-top: 10px" id="KFADP"></canvas>
            </div>
          </div>
          <% if(data.key_feature_adoption_deep_security.notes?.length> 0) { %>
          <div>
            <%- include('./partials/recommendations', { notes: data.key_feature_adoption_deep_security.notes }) %>
          </div>
          <% } %>
      </div>
    </div>
    <% } %>

    <!-- agents version summary -->
    <div class="print-page" id="<%= data.agent_versions_summary.id %>">
      <p
        style="
          font-size: 4rem;
          font-weight: 700;
          color: #090c9b;
          margin-bottom: 0px;
        "
      >
        Agent Versions Summary
      </p>
      <% if(data.agent_versions_summary.agent_version_chart.visible) { %>
      <div
        style="
          display: flex;
          align-items: center;
          text-align: center;
        "
      >
        <div style="width: 80%; height: 400px; margin: 0 auto;">
          <canvas style="margin-top: 20px" id="pieChart"></canvas>
        </div>
      </div>
      <% } %>
      <% if(data.deep_security?.server_workload_protection_chart?.visible) { %>
      <div>
        <p
          style="
            font-size: 26px;
            font-weight: bold;
            color: #090c9b;
            margin-bottom: 0px;
          "
        >
          Deep Security
        </p>
        <div style="width: 750px; height: 350px; margin: auto">
          <canvas style="margin-top: 10px" id="dpsWPChart"></canvas>
        </div>
      </div>
      <% } %>
      <% if(data.agent_versions_summary?.server_workload_protection_chart?.visible) { %>
      <div>
        <p
          style="
            font-size: 26px;
            font-weight: bold;
            color: #090c9b;
            margin-bottom: 0px;
          "
        >
        C1WS / Server & Workload Security / Protection
      </p>
      <div style="width: 750px; height: 350px; margin: auto">
          <canvas style="margin-top: 10px" id="horizontalBarCharts22"></canvas>
        </div>
      </div>
      <% } %>
      <% if(data.agent_versions_summary.standard_endpoint_protection_chart.visible) { %>
      <div style="<%= (data.agent_versions_summary?.server_workload_protection_chart?.visible && data.deep_security?.server_workload_protection_chart?.visible) ? 'page-break-before:always;' : '' %>">
        <p
          style="
            font-size: 26px;
            font-weight: bold;
            color: #090c9b;
            margin-bottom: 0px;
            "
          >
            Apex one as Service / Std Endpoint Protection
          </p>
          <div style="width: 750px; height: 350px; margin: auto">
            <canvas style="margin-top: 10px;" id="horizontalBarCharts23"></canvas>
          </div>
      </div>
      <% } %>
      <% if(data.agent_versions_summary.notes?.length> 0) { %>
      <div>
        <%- include('./partials/recommendations', { notes: data.agent_versions_summary.notes }) %>
      </div>
      <% } %>
    </div>
  </div>

  <!-- scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.js"
    integrity="sha512-ZwR1/gSZM3ai6vCdI+LVF1zSq/5HznD3ZSTk7kajkaj4D292NLuduDCO1c/NT8Id+jE58KYLKT7hXnbtryGmMg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
  <script src="https://d3js.org/d3.v6.min.js"></script>


  <script type="text/javascript">
    const gracefulStringWrap = (text, maxLength) => {
      if (text.length <= maxLength) return text

      let parts = []

      let startIndex = 0
      while (true) {
        let i = text.indexOf(" ", startIndex + maxLength)
        if (i === -1) {
          parts.push(text.substring(startIndex, text.length))
          return parts
        }
        parts.push(text.substring(startIndex, i))
        startIndex = i + 1
      }
    }
    Chart.defaults.color = "#292929";
    Chart.defaults.font.size = 14;
    Chart.defaults.scales.linear.grace = "5%";
    Chart.defaults.responsive = true;
    Chart.defaults.maintainAspectRatio = false;

    Chart.register({
      id: "LabelSplit",
      beforeLayout: function (chart) {
        chart.data?.labels?.forEach(function (label, i, labelArr) {
          if (typeof label == "string" && label.length > 15) {
            labelArr[i] = gracefulStringWrap(label, 15);
          }
        });
      },
    });

    const doughnutChartOptions = {
      responsive: true,
      plugins: {
        legend: {
          display: false
        },
        tooltip: {
          enabled: true
        }
      }
    }

    const barChartOptionsIndexAxisY = {
      indexAxis: 'y',
      plugins: {
        legend: {
          labels: {
            font: {
              weight: "bold"
            }
          }
        },
        datalabels: {
          anchor: 'end',
          align: 'end',
          formatter: (value) => value,
          color: '#090c9b',
          font: {
            weight: 'bold',
            size: 14
          }
        }
      },
      layout: {
        padding: {
          right: 30,
          left: 10,
        },
      },
      scales: {
        x: {
          grid: {
            display: true
          },
          beginAtZero: true,
          ticks: {
            font: {
              weight: "bold"
            }
          }
        },
        y: {
          grid: {
            display: false
          },
          ticks: {
            font: {
              weight: "bold"
            }
          }
        }
      }
    }

    <% if(data.risk_metrics.top_risk_incidents.indicators.length > 0) { %>
      const indicators = <%- JSON.stringify(data.risk_metrics.top_risk_incidents.indicators) %>;

      function valueToAngle(value) {
        const mapping = { "Low": 45, "Medium": 180, "High": 315 };
        return mapping[value] || 180;
      }

      indicators.forEach((indicator, index) => {
          const width = 200;
          const height = 200;
          const radius = Math.min(width, height) / 2;
          const needleLength = radius * 0.8;

          const container = d3.select(`#gauge${index}`);

          // Append value label on top with different class
          container.append("div")
              .attr("class", "gauge-value-label")
              .text(indicator.value);

          const svg = container.append("svg")
              .attr("width", width)
              .attr("height", height);

          const valueMap = {
              "Low": -Math.PI / 1.2,    // Pointing straight up (0 degrees)
              "Medium": Math.PI * 1.5,            // Pointing to the right (90 degrees)
              "High": Math.PI * 1.8    // Pointing straight down (180 degrees)
          };

          const colorMap = {
              "Low": "green",
              "Medium": "orange",
              "High": "red"
          };

          const angle = valueMap[indicator.value];
          const arcColor = colorMap[indicator.value];

          // Draw the full arc in the corresponding color
          const arc = d3.arc()
              .innerRadius(radius - 20)
              .outerRadius(radius)
              .startAngle(-Math.PI / 2)
              .endAngle(Math.PI / 2);

          svg.append("path")
              .attr("d", arc)
              .attr("transform", `translate(${width / 2}, ${height / 2})`)
              .attr("fill", arcColor);

          // Draw the needle
          svg.append("line")
              .attr("x1", width / 2)
              .attr("y1", height / 2)
              .attr("x2", width / 2 + needleLength * Math.cos(angle))
              .attr("y2", height / 2 + needleLength * Math.sin(angle))
              .attr("stroke", "steelblue")
              .attr("stroke-width", 4);

          // Add a circle at the needle base
          svg.append("circle")
              .attr("cx", width / 2)
              .attr("cy", height / 2)
              .attr("r", 5)
              .attr("fill", "steelblue");

          // Append risk name label at the bottom with different class
          container.append("div")
              .attr("class", "gauge-risk-label")
              .text(indicator.risk_name);
      });
    <% } %>

    <% if(data.about_this_report.chart.datasets.length > 0) { %>
      const ctx1 = document.getElementById('workloadSecurity').getContext('2d');
      const workloadSecurityChart = new Chart(ctx1, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.about_this_report.chart.datasets[0].label) %>,
              datasets: <%- JSON.stringify(data.about_this_report.chart.datasets) %>
          },

          options: {
              plugins: {
                legend: {
                  display: false
                },
                datalabels: {
                  anchor: 'end',
                  align: 'end',
                  offset: -6,
                  formatter: (value) => value,
                  color: '#090c9b',
                  font: {
                    weight: 'bold',
                    size: 14
                  }
                }
              },
              layout: {
                padding: {
                  right: 30,
                  left: 10,
                  top: 20,
                  bottom: 10
                },
              },
              scales: {
                x: {
                  grid: {
                    display: false
                  },
                  ticks: {
                    font: {
                      weight: "bold"
                    }
                  }
                },
                y: {
                  grid: {
                    display: true
                  },
                  beginAtZero: true,
                  ticks: {
                    font: {
                      weight: "bold"
                    }
                  }
                }
              }
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.detailed_summary.risk_index_chart.datasets.length > 0) { %>
      // Risk Index Charts //
      const ctx4 = document.getElementById('riskIndex').getContext('2d');
      const riskIndexChart = new Chart(ctx4, {
          type: 'doughnut',
          data: {
              labels: "",
              datasets: <%- JSON.stringify(data.detailed_summary.risk_index_chart.datasets) %>
          },
          options: doughnutChartOptions
      });
    <% } %>

    <% if(data.risk_metrics.last_risk_score.visible && data.risk_metrics.last_risk_score?.charts[0].datasets[0].data[0] !== 0) { %>
      // Risk Score Charts //
      const ctx5 = document.getElementById('riskScore0').getContext('2d');
      const riskScore = new Chart(ctx5, {
          type: 'doughnut',
          data: {
              labels: "",
              datasets: <%- JSON.stringify(data.risk_metrics.last_risk_score?.charts[0].datasets) %>
          },
          options: doughnutChartOptions
      });
    <% } %>

    <% if(data.risk_metrics.last_risk_score.visible && data.risk_metrics.last_risk_score?.charts[1].datasets[0].data[0] !== 0) { %>
      const ctx6 = document.getElementById('riskScore1').getContext('2d');
      const riskScore2 = new Chart(ctx6, {
          type: 'doughnut',
          data: {
              labels: "",
              datasets: <%- JSON.stringify(data.risk_metrics.last_risk_score?.charts[1].datasets) %>
          },
          options: doughnutChartOptions
      });
    <% } %>

    <% if(data.risk_metrics.last_risk_score.visible && data.risk_metrics.last_risk_score?.charts[2].datasets[0].data[0] !== 0) { %>
      const ctx7 = document.getElementById('riskScore2').getContext('2d');
      const riskScore3 = new Chart(ctx7, {
          type: 'doughnut',
          data: {
              labels: "",
              datasets: <%- JSON.stringify(data.risk_metrics.last_risk_score?.charts[2].datasets) %>
          },
          options: doughnutChartOptions
      });
    <% } %>

    <% if(data.threat_intel_summary.count_of_advisory_chart?.datasets.length > 0) { %>
      // threat intel summary
      const ctx24 = document.getElementById('TISHorizontalBar1').getContext('2d');
      const TISHorizontalBar1 = new Chart(ctx24, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.threat_intel_summary.count_of_advisory_chart?.key) %>,
              datasets: <%- JSON.stringify(data.threat_intel_summary.count_of_advisory_chart?.datasets) %>
          },
          options: barChartOptionsIndexAxisY,
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.threat_intel_summary.ioc_chart?.datasets.length > 0) { %>
      // Horizontal Bar Chart //
      const ctx9 = document.getElementById('horizontalBarCharts').getContext('2d');
      const horizontalBarChart = new Chart(ctx9, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.threat_intel_summary.ioc_chart?.key) %>,
              datasets: <%- JSON.stringify(data.threat_intel_summary.ioc_chart?.datasets) %>
          },
          options: barChartOptionsIndexAxisY,
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.overall_incident_summary.incidents_chart.datasets.length > 0) { %>
      const ctx10 = document.getElementById('horizontalBarCharts2').getContext('2d');
      const horizontalBarChart2 = new Chart(ctx10, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.overall_incident_summary.incidents_chart.key) %>,
              datasets: <%- JSON.stringify(data.overall_incident_summary.incidents_chart.datasets) %>
          },
          options: barChartOptionsIndexAxisY,
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.slo_summary.slo_chart.datasets.length > 0) { %>
      const ctx11 = document.getElementById('horizontalBarCharts3').getContext('2d');
      const horizontalBarChart3 = new Chart(ctx11, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.slo_summary.slo_chart.key) %>,
              datasets: <%- JSON.stringify(data.slo_summary.slo_chart.datasets) %>
          },
          options: barChartOptionsIndexAxisY,
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.detection_summary_apex_one.visible && data.detection_summary_apex_one.detection_chart.datasets.length > 0) { %>
      const ctx12 = document.getElementById('horizontalBarCharts4').getContext('2d');
      const horizontalBarChart4 = new Chart(ctx12, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.detection_summary_apex_one.detection_chart.key) %>,
              datasets: <%- JSON.stringify(data.detection_summary_apex_one.detection_chart.datasets) %>
          },
          options: {
              ...barChartOptionsIndexAxisY,
              maintainAspectRatio: false
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.detection_summary_apex_one.visible && data.detection_summary_apex_one.attempts_blocked_chart.datasets.length > 0) { %>
      const ctx13 = document.getElementById('horizontalBarCharts5').getContext('2d');
      const horizontalBarChart5 = new Chart(ctx13, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.detection_summary_apex_one.attempts_blocked_chart.key) %>,
              datasets: <%- JSON.stringify(data.detection_summary_apex_one.attempts_blocked_chart.datasets) %>
          },
          options: {
              ...barChartOptionsIndexAxisY,
              maintainAspectRatio: false
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.email_quarantine_summary_cas.visible && data.email_quarantine_summary_cas.status_chart.datasets.length > 0) { %>
      const ctx14 = document.getElementById('horizontalBarCharts6').getContext('2d');
      const horizontalBarChart6 = new Chart(ctx14, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.email_quarantine_summary_cas.status_chart.key) %>,
              datasets: <%- JSON.stringify(data.email_quarantine_summary_cas.status_chart.datasets) %>
          },
          options: {
              ...barChartOptionsIndexAxisY,
              maintainAspectRatio: false
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.top_vulnerabilities_detected.impact_chart.datasets.length > 0) { %>
      const ctx15 = document.getElementById('horizontalBarCharts7').getContext('2d');
      const horizontalBarChart7 = new Chart(ctx15, {
          type: 'bar',
          data: {
              labels:<%- JSON.stringify(data.top_vulnerabilities_detected.impact_chart.key) %>,
              datasets: <%- JSON.stringify(data.top_vulnerabilities_detected.impact_chart.datasets) %>
          },
          options: {
              ...barChartOptionsIndexAxisY,
              maintainAspectRatio: false
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.top_risk_device.visible && data.top_risk_device.risk_score_chart.datasets.length > 0) { %>
      const ctx16 = document.getElementById('horizontalBarCharts8').getContext('2d');
      const horizontalBarChart8 = new Chart(ctx16, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.top_risk_device.risk_score_chart.key) %>,
              datasets: <%- JSON.stringify(data.top_risk_device.risk_score_chart.datasets) %>
          },
          options: {
              ...barChartOptionsIndexAxisY,
              maintainAspectRatio: false
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.top_risk_users.visible && data.top_risk_users.risk_score_chart.datasets.length > 0) { %>
      const ctx17 = document.getElementById('horizontalBarCharts9').getContext('2d');
      const horizontalBarChart9 = new Chart(ctx17, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.top_risk_users.risk_score_chart.key) %>,
              datasets: <%- JSON.stringify(data.top_risk_users.risk_score_chart.datasets) %>
          },
          options: {
              ...barChartOptionsIndexAxisY,
              maintainAspectRatio: false
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.endpoint_feature_compliance.compliance_chart.datasets.length > 0) { %>
      const ctx18 = document.getElementById('horizontalBarCharts10').getContext('2d');
      const horizontalBarChart10 = new Chart(ctx18, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.endpoint_feature_compliance.compliance_chart.key) %>,
              datasets: <%- JSON.stringify(data.endpoint_feature_compliance.compliance_chart.datasets) %>
          },
          options: barChartOptionsIndexAxisY,
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.key_feature_adoption_apex_one.visible && data.key_feature_adoption_apex_one.apex_one_chart.datasets.length > 0) { %>
      const ctx19 = document.getElementById('myChart').getContext('2d');
      const myChart = new Chart(ctx19, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.key_feature_adoption_apex_one.apex_one_chart.key) %>,
              datasets: <%- JSON.stringify(data.key_feature_adoption_apex_one.apex_one_chart.datasets) %>
          },
          options: {
              ...barChartOptionsIndexAxisY,
              maintainAspectRatio: false
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.key_feature_adoption_server_workload.visible && data.key_feature_adoption_server_workload.workload_security_chart.datasets.length > 0) { %>
      const ctx20 = document.getElementById('myChart2').getContext('2d');
      const myChart2 = new Chart(ctx20, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.key_feature_adoption_server_workload.workload_security_chart.key) %>,
              datasets: <%- JSON.stringify(data.key_feature_adoption_server_workload.workload_security_chart.datasets) %>
          },
          options: {
              ...barChartOptionsIndexAxisY,
              maintainAspectRatio: false
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.key_feature_adoption_deep_security.visible && data.key_feature_adoption_deep_security.deep_security_chart.datasets.length > 0) { %>
      // KFA Deep security
      const ctx25 = document.getElementById('KFADP').getContext('2d');
      const KFADP = new Chart(ctx25, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.key_feature_adoption_deep_security.deep_security_chart.key) %>,
              datasets: <%- JSON.stringify(data.key_feature_adoption_deep_security.deep_security_chart.datasets) %>
          },
          options: {
              ...barChartOptionsIndexAxisY,
              maintainAspectRatio: false
          },
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.agent_versions_summary.agent_version_chart.visible && data.agent_versions_summary.agent_version_chart.datasets.length > 0) { %>
      const ctx21 = document.getElementById('pieChart').getContext('2d');

      const pieChart = new Chart(ctx21, {
        type: 'bar',
        data: {
          labels: <%- JSON.stringify(data.agent_versions_summary.agent_version_chart.key) %>,
          datasets: <%- JSON.stringify(data.agent_versions_summary.agent_version_chart.datasets) %>
        },
        options: {
          scales: {
            x: {
              grid: {
                display: false,
              },
              ticks: {
                font: {
                  weight: "bold"
                }
              }
            },
            y: {
              grid: {
                display: false,
              },
              ticks: {
                font: {
                  weight: "bold"
                }
              }
            },
          },
          maintainAspectRatio: false,
          plugins: {
            datalabels: {
              anchor: "end",
              align: "end",
            },
            legend: {
              display: false,
            },
          },
        },
        plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.agent_versions_summary?.server_workload_protection_chart?.visible && data.agent_versions_summary?.server_workload_protection_chart?.datasets.length > 0 ) { %>
      const ctx22 = document.getElementById('horizontalBarCharts22').getContext('2d');
      const horizontalBarChart22 = new Chart(ctx22, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.agent_versions_summary.server_workload_protection_chart.key) %>,
              datasets: <%- JSON.stringify(data.agent_versions_summary.server_workload_protection_chart.datasets) %>
          },
          options: barChartOptionsIndexAxisY,
          plugins: [ChartDataLabels]
      });
    <% } %>

    <% if(data.agent_versions_summary.standard_endpoint_protection_chart.visible && data.agent_versions_summary.standard_endpoint_protection_chart.datasets.length > 0) { %>
      const ctx23 = document.getElementById('horizontalBarCharts23').getContext('2d');
      const horizontalBarChart23 = new Chart(ctx23, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.agent_versions_summary.standard_endpoint_protection_chart.key) %>,
              datasets: <%- JSON.stringify(data.agent_versions_summary.standard_endpoint_protection_chart.datasets) %>
          },
          options: barChartOptionsIndexAxisY,
          plugins: [ChartDataLabels]
      });
    <% } %>

    // deep security
    <% if(data.deep_security?.server_workload_protection_chart?.visible && data.deep_security?.server_workload_protection_chart?.datasets.length > 0 ) { %>
      const dpsWPChartCtx = document.getElementById('dpsWPChart').getContext('2d');
      const dpsWPChart = new Chart(dpsWPChartCtx, {
          type: 'bar',
          data: {
              labels: <%- JSON.stringify(data.deep_security.server_workload_protection_chart.key) %>,
              datasets: <%- JSON.stringify(data.deep_security.server_workload_protection_chart.datasets) %>
          },
          options: barChartOptionsIndexAxisY,
          plugins: [ChartDataLabels]
      });
    <% } %>
  </script>

</body>

</html>